{"version":3,"file":"app.bundle.js","mappings":"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","sources":["webpack://flowater-webpack/webpack/runtime/chunk loaded","webpack://flowater-webpack/./src/scripts/pages/auth/login/login-presenter.js","webpack://flowater-webpack/./src/scripts/pages/auth/register/register-page.js","webpack://flowater-webpack/./src/scripts/data/story-idb.js","webpack://flowater-webpack/./src/scripts/pages/home/home-page.js","webpack://flowater-webpack/./src/scripts/pages/laporan/laporan-presenter.js","webpack://flowater-webpack/./src/scripts/pages/laporan/laporan-page.js","webpack://flowater-webpack/./src/scripts/pages/addlaporan/add-laporan-presenter.js","webpack://flowater-webpack/./src/scripts/pages/addlaporan/add-laporan-page.js","webpack://flowater-webpack/./src/scripts/pages/detail/detail-presenter.js","webpack://flowater-webpack/./src/scripts/pages/error/404.js","webpack://flowater-webpack/./src/scripts/pages/bookmark/bookmark-page.js","webpack://flowater-webpack/./src/scripts/routes/routes.js","webpack://flowater-webpack/./src/scripts/pages/detail/detail-page.js","webpack://flowater-webpack/./src/scripts/routes/url-parser.js","webpack://flowater-webpack/./src/scripts/utils/notif.js","webpack://flowater-webpack/./src/scripts/pages/app.js","webpack://flowater-webpack/./src/scripts/index.js","webpack://flowater-webpack/./src/scripts/utils/loader.js","webpack://flowater-webpack/./src/scripts/config.js","webpack://flowater-webpack/./src/scripts/pages/auth/login/login-page.js","webpack://flowater-webpack/./src/scripts/utils/auth.js","webpack://flowater-webpack/./src/scripts/pages/auth/register/register-presenter.js","webpack://flowater-webpack/./src/scripts/data/api.js","webpack://flowater-webpack/webpack/bootstrap","webpack://flowater-webpack/webpack/runtime/amd options","webpack://flowater-webpack/webpack/runtime/compat get default export","webpack://flowater-webpack/webpack/runtime/define property getters","webpack://flowater-webpack/webpack/runtime/hasOwnProperty shorthand","webpack://flowater-webpack/webpack/runtime/make namespace object","webpack://flowater-webpack/webpack/runtime/publicPath","webpack://flowater-webpack/webpack/runtime/jsonp chunk loading","webpack://flowater-webpack/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","import { AuthAPI } from \"../../../data/api\";\r\nimport { setAuthToken } from \"../../../utils/auth\";\r\nimport { showLoader, hideLoader } from \"../../../utils/loader\";\r\n\r\nexport default class LoginPresenter {\r\n  constructor(view) {\r\n    this.view = view;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.form = document.getElementById(\"login-form\");\r\n    this.errorElement = document.getElementById(\"login-error\");\r\n    this.bindEvents();\r\n  }\r\n\r\n  bindEvents() {\r\n    this.form.addEventListener(\"submit\", async (e) => {\r\n      e.preventDefault();\r\n      await this.handleLogin();\r\n    });\r\n  }\r\n\r\n  async handleLogin() {\r\n    const email = document.getElementById(\"email\").value;\r\n    const password = document.getElementById(\"password\").value;\r\n\r\n    this.clearErrors();\r\n\r\n    if (!email || !password) {\r\n      this.showError(\"Email dan password harus diisi\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      showLoader();\r\n      const response = await AuthAPI.login({ email, password });\r\n\r\n      if (response.error) {\r\n        this.showError(response.message);\r\n      } else {\r\n        setAuthToken(response.loginResult.token);\r\n        this.showSuccess(\"Login berhasil! Mengarahkan...\");\r\n        setTimeout(() => {\r\n          window.location.href = \"#/\";\r\n        }, 1500);\r\n      }\r\n    } catch (error) {\r\n      this.showError(\"Gagal login. Silakan coba lagi.\");\r\n      console.error(\"Login error:\", error);\r\n    } finally {\r\n      hideLoader();\r\n    }\r\n  }\r\n\r\n  showError(message) {\r\n    this.errorElement.textContent = message;\r\n    this.errorElement.className = \"error-message error\";\r\n    this.errorElement.style.display = \"block\";\r\n    this.errorElement.focus();\r\n  }\r\n\r\n  showSuccess(message) {\r\n    this.errorElement.textContent = message;\r\n    this.errorElement.className = \"error-message success\";\r\n    this.errorElement.style.display = \"block\";\r\n  }\r\n\r\n  clearErrors() {\r\n    this.errorElement.style.display = \"none\";\r\n    this.errorElement.className = \"error-message\";\r\n  }\r\n}\r\n","import RegisterPresenter from \"./register-presenter\";\r\n\r\nexport default class RegisterPage {\r\n  async render() {\r\n    const container = document.createElement(\"div\");\r\n    container.innerHTML = `\r\n      <main id=\"mainContent\">\r\n        <a href=\"#mainContent\" class=\"skip-link\">Skip to content</a>\r\n        <article class=\"auth-container\" aria-labelledby=\"registerHeading\">\r\n          <h1 id=\"registerHeading\" style=\"text-align:center; margin-bottom:5px;\" >Daftar</h1>\r\n          <form id=\"register-form\" aria-label=\"Registration form\">\r\n            <div class=\"form-group\">\r\n              <label for=\"name\">Nama Lengkap</label>\r\n              <input \r\n                type=\"text\" \r\n                id=\"name\" \r\n                name=\"name\" \r\n                required\r\n                aria-required=\"true\"\r\n                autocomplete=\"name\"\r\n                placeholder=\"Masukkan nama lengkap anda\"\r\n              >\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"email\">Email</label>\r\n              <input \r\n                type=\"email\" \r\n                id=\"email\" \r\n                name=\"email\" \r\n                required\r\n                aria-required=\"true\"\r\n                autocomplete=\"email\"\r\n                placeholder=\"Masukkan email anda\"\r\n              >\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label for=\"password\">Password</label>\r\n              <input \r\n                type=\"password\" \r\n                id=\"password\" \r\n                name=\"password\" \r\n                required\r\n                minlength=\"8\"\r\n                aria-required=\"true\"\r\n                autocomplete=\"new-password\"\r\n                placeholder=\"Masukkan password anda\"\r\n                aria-describedby=\"passwordHelp\"\r\n              >\r\n              <small id=\"passwordHelp\" class=\"help-text\">Minimum 8 karakter</small>\r\n            </div>\r\n            <div id=\"register-error\" class=\"error-message\" role=\"alert\" aria-live=\"assertive\" style=\"display: none;\"></div>\r\n            <button type=\"submit\" class=\"btn\">Daftar</button>\r\n          </form>\r\n          <p>Sudah memiliki akun? <a href=\"#/login\">Masuk</a></p>\r\n        </article>\r\n      </main>\r\n    `;\r\n    return container;\r\n  }\r\n\r\n  async afterRender() {\r\n    const skipLink = document.querySelector(\".skip-link\");\r\n    skipLink.addEventListener(\"click\", (e) => {\r\n      e.preventDefault();\r\n      document.getElementById(\"name\").focus();\r\n    });\r\n    new RegisterPresenter(this);\r\n  }\r\n}\r\n","import { openDB } from \"idb\";\r\n\r\nconst DB_VERSION = 3; // Pastikan versi konsisten\r\nconst DB_NAME = \"story-db\";\r\nconst STORY_STORE = \"stories\";\r\nconst BOOKMARK_STORE = \"bookmarks\";\r\n\r\nconst dbPromise = openDB(DB_NAME, DB_VERSION, {\r\n  upgrade(db) {\r\n    if (!db.objectStoreNames.contains(STORY_STORE)) {\r\n      db.createObjectStore(STORY_STORE, { keyPath: \"id\" });\r\n    }\r\n    if (!db.objectStoreNames.contains(BOOKMARK_STORE)) {\r\n      db.createObjectStore(BOOKMARK_STORE, { keyPath: \"id\" });\r\n    }\r\n  },\r\n});\r\n\r\nconst StoryIDB = {\r\n  // Stories\r\n  async getAllStories() {\r\n    return (await dbPromise).getAll(STORY_STORE);\r\n  },\r\n\r\n  async saveStories(stories) {\r\n    const db = await dbPromise;\r\n    const tx = db.transaction(STORY_STORE, \"readwrite\");\r\n    for (const story of stories) {\r\n      tx.store.put(story);\r\n    }\r\n    return tx.done;\r\n  },\r\n\r\n  async deleteStory(id) {\r\n    return (await dbPromise).delete(STORY_STORE, id);\r\n  },\r\n\r\n  async clearAll() {\r\n    return (await dbPromise).clear(STORY_STORE);\r\n  },\r\n\r\n  // Bookmarks\r\n  async addBookmark(story) {\r\n    try {\r\n      const db = await dbPromise;\r\n      const completeStory = {\r\n        id: story.id,\r\n        name: story.name || \"Untitled Story\",\r\n        description: story.description || \"\",\r\n        photoUrl: story.photoUrl || \"\",\r\n        lat: story.lat || null,\r\n        lon: story.lon || null,\r\n        createdAt: story.createdAt || new Date().toISOString(),\r\n      };\r\n      await db.put(BOOKMARK_STORE, completeStory);\r\n      return completeStory;\r\n    } catch (error) {\r\n      console.error(\"Failed to add bookmark:\", error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  async isBookmarked(id) {\r\n    try {\r\n      const db = await dbPromise;\r\n      const bookmark = await db.get(BOOKMARK_STORE, id);\r\n      return !!bookmark;\r\n    } catch (error) {\r\n      console.error(\"Failed to check bookmark:\", error);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  async deleteBookmark(id) {\r\n    return (await dbPromise).delete(BOOKMARK_STORE, id);\r\n  },\r\n\r\n  async getAllBookmarks() {\r\n    return (await dbPromise).getAll(BOOKMARK_STORE);\r\n  },\r\n};\r\n\r\nexport default StoryIDB;\r\n","export default class HomePage {\n  async render() {\n    const container = document.createElement(\"div\");\n    container.innerHTML = `\n      <section class=\"hero\">\n        <div class=\"hero-content\">\n          <h1 class=\"hero-title\">Sharing stories pengguna Flowater</h1>\n          <p class=\"hero-subtitle\">(Komplen atau Laporan)</p>\n          <a href=\"#/addLaporan\" class=\"hero-button\">Buat Laporan Sekarang</a>\n        </div>\n      </section>\n    `;\n    return container;\n  }\n\n  async afterRender() {}\n}\n","import { StoryAPI } from \"../../data/api\";\r\nimport StoryIDB from \"../../data/story-idb\";\r\n\r\nexport default class LaporanPresenter {\r\n  constructor(view) {\r\n    this.view = view;\r\n  }\r\n\r\n  async init() {\r\n    try {\r\n      const { listStory } = await this._getAllStories();\r\n\r\n      if (listStory && listStory.length > 0) {\r\n        const validStories = listStory.filter((story) => story.id);\r\n        await StoryIDB.saveStories(validStories);\r\n        this.view.showStories(validStories);\r\n      } else {\r\n        const localStories = await StoryIDB.getAllStories();\r\n        this.view.showStories(localStories);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      const localStories = await StoryIDB.getAllStories();\r\n      this.view.showStories(localStories.length > 0 ? localStories : []);\r\n    }\r\n  }\r\n\r\n  async _getAllStories() {\r\n    try {\r\n      const response = await StoryAPI.getAllStories();\r\n      return response;\r\n    } catch (error) {\r\n      console.error(\"Error fetching stories:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n","import LaporanPresenter from \"./laporan-presenter\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\n\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require(\"leaflet/dist/images/marker-icon-2x.png\"),\n  iconUrl: require(\"leaflet/dist/images/marker-icon.png\"),\n  shadowUrl: require(\"leaflet/dist/images/marker-shadow.png\"),\n});\n\nexport default class LaporanPage {\n  constructor() {\n    this.storiesContainer = null;\n    this.map = null;\n  }\n\n  async render() {\n    const container = document.createElement(\"div\");\n    container.innerHTML = `\n    <main id=\"mainContent\" tabindex=\"-1\">\n      <section>\n        <div class=\"reports-list__map__container\">\n          <div id=\"map\" class=\"reports-list__map\"></div>\n          <div id=\"map-loading-container\"></div>\n        </div>\n      </section>\n      <br>\n      <section class=\"container\">\n      <button id=\"clear-data-btn\" class=\"cta-button danger\">Hapus Data Lokal</button>\n\n        <h1 style=\"text-align: center; margin-top:10px;\">Laporan Pengguna</h1>\n        <div id=\"stories-list\" class=\"stories-grid\"></div>\n      </section>\n      </main>\n    `;\n    return container;\n  }\n\n  async afterRender() {\n    const clearBtn = document.getElementById(\"clear-data-btn\");\n    if (clearBtn) {\n      clearBtn.addEventListener(\"click\", async () => {\n        await import(\"../../data/story-idb\").then((mod) =>\n          mod.default.clearAll()\n        );\n        alert(\"Data lokal dihapus.\");\n      });\n    }\n\n    const skipLink = document.querySelector(\".skip-link\");\n    if (skipLink) {\n      skipLink.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        const focusTarget =\n          document.getElementById(\"stories-list\") ||\n          document.querySelector(\"main\");\n        if (focusTarget) {\n          focusTarget.setAttribute(\"tabindex\", \"-1\");\n          focusTarget.focus();\n        }\n      });\n    }\n    await this.initialMap();\n  }\n\n  async initialMap() {\n    this.map = L.map(\"map\", {\n      center: [-6.914864, 107.608238],\n      scrollWheelZoom: false,\n      zoom: 13,\n    });\n\n    L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n      maxZoom: 19,\n    }).addTo(this.map);\n\n    this.storiesContainer = document.getElementById(\"stories-list\");\n    new LaporanPresenter(this).init();\n  }\n\n  addMarkers(stories) {\n    if (!this.map) return;\n\n    this.map.eachLayer((layer) => {\n      if (layer instanceof L.Marker) {\n        this.map.removeLayer(layer);\n      }\n    });\n\n    stories.forEach((story) => {\n      if (story.lat && story.lon) {\n        const marker = L.marker([story.lat, story.lon]).addTo(this.map)\n          .bindPopup(`\n            <b>${story.name}</b><br>\n            ${story.description}<br>\n            <small>${new Date(story.createdAt).toLocaleString()}</small>\n          `);\n      }\n    });\n\n    if (stories.length > 0 && stories[0].lat && stories[0].lon) {\n      this.map.setView([stories[0].lat, stories[0].lon], 13);\n    }\n  }\n\n  showStories(stories, withBookmark = true) {\n    if (!this.storiesContainer) return;\n\n    if (stories.length === 0) {\n      this.storiesContainer.innerHTML = `<p>Tidak ada cerita.</p>`;\n      return;\n    }\n\n    this.storiesContainer.innerHTML = stories\n      .map((story) => this._generateStoryCard(story, withBookmark))\n      .join(\"\");\n\n    this.addMarkers(stories);\n    if (withBookmark) this._attachBookmarkListeners(stories);\n  }\n\n  showError(message) {\n    if (this.storiesContainer) {\n      this.storiesContainer.innerHTML = `<p class=\"error\">Gagal memuat stories: ${message}</p>`;\n    }\n  }\n\n  _generateStoryCard(story, withBookmark = false) {\n    return `\n    <div class=\"story-card\">\n      <img src=\"${story.photoUrl}\" alt=\"${story.name}\" class=\"story-img\"/>\n      <div class=\"story-content\">\n        <div class=\"story-text\">\n          <h3>${story.name}</h3>\n          <p>${story.description}</p>\n          <small>${new Date(story.createdAt).toLocaleString()}</small>\n          ${\n            story.lat && story.lon\n              ? `<p>Lokasi: ${story.lat}, ${story.lon}</p>`\n              : \"\"\n          }\n        </div>\n        <div class=\"story-actions\">\n          <a href=\"#/detail/${story.id}\" class=\"cta-button\">Lihat Detail</a>\n          ${\n            withBookmark\n              ? `<button class=\"bookmark-btn cta-button\" data-id=\"${story.id}\">⭐ Simpan</button>`\n              : \"\"\n          }\n        </div>\n      </div>\n    </div>\n  `;\n  }\n\n  async _attachBookmarkListeners(stories) {\n    const storyIdb = await import(\"../../data/story-idb\");\n    const { addBookmark, deleteBookmark, isBookmarked } = storyIdb.default;\n\n    document.querySelectorAll(\".bookmark-btn\").forEach((btn) => {\n      const id = btn.dataset.id;\n      const story = stories.find((s) => s.id === id);\n      if (!story) return;\n\n      btn.className = \"bookmark-btn cta-button\";\n\n      isBookmarked(id).then((bookmarked) => {\n        btn.textContent = bookmarked ? \"❌ Hapus Bookmark\" : \"⭐ Simpan\";\n        btn.classList.toggle(\"bookmarked\", bookmarked);\n      });\n\n      btn.addEventListener(\"click\", async (e) => {\n        e.stopPropagation();\n        const bookmarked = await isBookmarked(id);\n\n        try {\n          if (bookmarked) {\n            await deleteBookmark(id);\n            btn.textContent = \"⭐ Simpan\";\n            btn.classList.remove(\"bookmarked\");\n          } else {\n            await addBookmark(story);\n            btn.textContent = \"❌ Hapus Bookmark\";\n            btn.classList.add(\"bookmarked\");\n          }\n        } catch (error) {\n          console.error(\"Bookmark error:\", error);\n          alert(\"Gagal memperbarui bookmark\");\n        }\n      });\n    });\n  }\n}\n","import { StoryAPI } from \"../../data/api\";\r\nimport { getAuthToken } from \"../../utils/auth\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport { NotificationAPI } from \"../../data/api\";\r\n\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: require(\"leaflet/dist/images/marker-icon-2x.png\"),\r\n  iconUrl: require(\"leaflet/dist/images/marker-icon.png\"),\r\n  shadowUrl: require(\"leaflet/dist/images/marker-shadow.png\"),\r\n});\r\n\r\nexport default class AddStoryPresenter {\r\n  constructor(view) {\r\n    this.view = view;\r\n    this.state = {\r\n      map: null,\r\n      marker: null,\r\n      photoFile: null,\r\n      mediaStream: null,\r\n      selectedCamera: null,\r\n    };\r\n  }\r\n\r\n  async init() {\r\n    try {\r\n      await this._setupDOMReferences();\r\n      await this._initializeMap();\r\n      this._setupEventListeners();\r\n      await this._loadCameras();\r\n    } catch (error) {\r\n      console.error(\"Presenter initialization failed:\", error);\r\n      this.view.showError(\"Gagal memuat halaman. Silakan coba lagi.\");\r\n    }\r\n  }\r\n\r\n  async _setupDOMReferences() {\r\n    this.elements = {\r\n      form: document.getElementById(\"story-form\"),\r\n      errorElement: document.getElementById(\"error-message\"),\r\n      photoInput: document.getElementById(\"photo\"),\r\n      photoPreview: document.getElementById(\"photo-preview\"),\r\n      cameraPreview: document.getElementById(\"camera-preview\"),\r\n      cameraSelect: document.getElementById(\"camera-select\"),\r\n      getLocationBtn: document.getElementById(\"get-location\"),\r\n      latInput: document.getElementById(\"lat\"),\r\n      lonInput: document.getElementById(\"lon\"),\r\n    };\r\n\r\n    const requiredElements = [\"form\", \"errorElement\", \"photoInput\"];\r\n    requiredElements.forEach((key) => {\r\n      if (!this.elements[key]) {\r\n        throw new Error(`Element ${key} not found`);\r\n      }\r\n    });\r\n  }\r\n\r\n  async _initializeMap() {\r\n    const mapContainer = document.getElementById(\"map\");\r\n    if (!mapContainer) {\r\n      throw new Error(\"Map container not found\");\r\n    }\r\n\r\n    if (mapContainer._leaflet_id) {\r\n      this.state.map = L.map(mapContainer, { reuse: true });\r\n      this.state.map.invalidateSize();\r\n      return;\r\n    }\r\n\r\n    this.state.map = L.map(mapContainer, {\r\n      center: [-6.914864, 107.608238],\r\n      zoom: 13,\r\n      tap: false,\r\n    });\r\n\r\n    L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n      attribution: \"&copy; OpenStreetMap contributors\",\r\n      maxZoom: 19,\r\n    }).addTo(this.state.map);\r\n\r\n    this.state.map.on(\"click\", (e) => {\r\n      this._setLocation(e.latlng.lat, e.latlng.lng);\r\n    });\r\n  }\r\n\r\n  _setupEventListeners() {\r\n    document.getElementById(\"camera-select\").addEventListener(\"change\", (e) => {\r\n      this._switchCamera(e.target.value).catch(console.error);\r\n    });\r\n    document\r\n      .getElementById(\"open-camera\")\r\n      .addEventListener(\"click\", () => this._toggleCamera());\r\n    document\r\n      .getElementById(\"capture-photo\")\r\n      .addEventListener(\"click\", () => this._capturePhoto());\r\n    document.getElementById(\"close-camera\").addEventListener(\"click\", () => {\r\n      this._stopCamera();\r\n      document.getElementById(\"camera-container\").hidden = true;\r\n    });\r\n\r\n    this.elements.getLocationBtn.addEventListener(\"click\", () =>\r\n      this._getCurrentLocation()\r\n    );\r\n    document\r\n      .getElementById(\"clear-location\")\r\n      .addEventListener(\"click\", () => this._clearLocation());\r\n\r\n    this.elements.form.addEventListener(\"submit\", (e) => this._handleSubmit(e));\r\n    this.elements.photoInput.addEventListener(\"change\", (e) =>\r\n      this._handleFileSelect(e)\r\n    );\r\n  }\r\n\r\n  async _loadCameras() {\r\n    try {\r\n      const tempStream = await navigator.mediaDevices.getUserMedia({\r\n        video: true,\r\n      });\r\n      tempStream.getTracks().forEach((track) => track.stop());\r\n\r\n      const devices = await navigator.mediaDevices.enumerateDevices();\r\n      this.state.availableCameras = devices.filter(\r\n        (d) => d.kind === \"videoinput\"\r\n      );\r\n\r\n      this._updateCameraOptions();\r\n\r\n      const backCamera = this.state.availableCameras.find(\r\n        (cam) =>\r\n          cam.label.toLowerCase().includes(\"back\") ||\r\n          cam.label.toLowerCase().includes(\"rear\")\r\n      );\r\n\r\n      if (backCamera) {\r\n        this.state.selectedCamera = backCamera.deviceId;\r\n        const select = document.getElementById(\"camera-select\");\r\n        select.value = backCamera.deviceId;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error loading cameras:\", error);\r\n      this.view.showError(\"Tidak dapat mengakses daftar kamera\");\r\n    }\r\n  }\r\n\r\n  _updateCameraOptions() {\r\n    const select = this.elements.cameraSelect;\r\n    select.innerHTML = '<option value=\"\">Pilih Kamera...</option>';\r\n\r\n    this.state.availableCameras.forEach((device) => {\r\n      const option = document.createElement(\"option\");\r\n      option.value = device.deviceId;\r\n      option.text = device.label || `Kamera ${select.options.length}`;\r\n      select.appendChild(option);\r\n    });\r\n  }\r\n\r\n  async _toggleCamera() {\r\n    if (this.state.mediaStream) {\r\n      await this._stopCamera();\r\n      document.getElementById(\"camera-container\").hidden = true;\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const constraints = {\r\n        video: {\r\n          deviceId: this.state.selectedCamera\r\n            ? { exact: this.state.selectedCamera }\r\n            : { facingMode: \"environment\" },\r\n          width: { ideal: 1280 },\r\n          height: { ideal: 720 },\r\n        },\r\n      };\r\n\r\n      this.state.mediaStream = await navigator.mediaDevices.getUserMedia(\r\n        constraints\r\n      );\r\n      const cameraPreview = document.getElementById(\"camera-preview\");\r\n\r\n      cameraPreview.srcObject = this.state.mediaStream;\r\n\r\n      await new Promise((resolve) => {\r\n        cameraPreview.onloadedmetadata = () => {\r\n          cameraPreview.play().then(resolve);\r\n        };\r\n      });\r\n\r\n      document.getElementById(\"camera-container\").hidden = false;\r\n    } catch (error) {\r\n      console.error(\"Camera error:\", error);\r\n      this.view.showError(\"Gagal memulai kamera\");\r\n      await this._stopCamera();\r\n    }\r\n  }\r\n\r\n  async _switchCamera(deviceId) {\r\n    await this._stopCamera();\r\n\r\n    const cameraPreview = document.getElementById(\"camera-preview\");\r\n    cameraPreview.srcObject = null;\r\n\r\n    if (!deviceId) {\r\n      this.state.selectedCamera = null;\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const constraints = {\r\n        video: {\r\n          deviceId: { exact: deviceId },\r\n          width: { ideal: 1280 },\r\n          height: { ideal: 720 },\r\n          facingMode: deviceId === \"environment\" ? \"environment\" : \"user\",\r\n        },\r\n      };\r\n\r\n      this.state.mediaStream = await navigator.mediaDevices.getUserMedia(\r\n        constraints\r\n      );\r\n      this.state.selectedCamera = deviceId;\r\n\r\n      cameraPreview.srcObject = this.state.mediaStream;\r\n\r\n      await new Promise((resolve) => {\r\n        cameraPreview.onloadedmetadata = () => {\r\n          cameraPreview\r\n            .play()\r\n            .then(resolve)\r\n            .catch((e) => {\r\n              console.error(\"Video play error:\", e);\r\n              this.view.showError(\"Kamera tidak dapat dimulai\");\r\n            });\r\n        };\r\n      });\r\n\r\n      document.getElementById(\"camera-container\").hidden = false;\r\n    } catch (error) {\r\n      console.error(\"Gagal switch kamera:\", error);\r\n      this._stopCamera();\r\n      this.view.showError(\"Gagal mengaktifkan kamera ini\");\r\n\r\n      document.getElementById(\"camera-select\").value =\r\n        this.state.selectedCamera || \"\";\r\n    }\r\n  }\r\n\r\n  async _stopCamera() {\r\n    if (this.state.mediaStream) {\r\n      this.state.mediaStream.getTracks().forEach((track) => {\r\n        track.stop();\r\n        track.enabled = false;\r\n      });\r\n\r\n      this.state.mediaStream = null;\r\n    }\r\n\r\n    const cameraPreview = document.getElementById(\"camera-preview\");\r\n    if (cameraPreview) {\r\n      cameraPreview.srcObject = null;\r\n      cameraPreview.load();\r\n      cameraPreview.pause();\r\n    }\r\n  }\r\n\r\n  _capturePhoto() {\r\n    const canvas = document.getElementById(\"photo-canvas\");\r\n    const video = document.getElementById(\"camera-preview\");\r\n\r\n    if (video.paused || video.readyState < HTMLMediaElement.HAVE_ENOUGH_DATA) {\r\n      this.view.showError(\"Kamera belum siap\");\r\n      return;\r\n    }\r\n\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n\r\n    const ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\r\n    canvas.toBlob(\r\n      (blob) => {\r\n        if (!blob) {\r\n          this.view.showError(\"Gagal mengambil foto\");\r\n          return;\r\n        }\r\n\r\n        this.state.photoFile = new File([blob], `photo-${Date.now()}.jpg`, {\r\n          type: \"image/jpeg\",\r\n        });\r\n\r\n        const photoPreview = document.getElementById(\"photo-preview\");\r\n        photoPreview.src = URL.createObjectURL(blob);\r\n        photoPreview.hidden = false;\r\n        document.getElementById(\"file-name\").textContent = \"Foto dari kamera\";\r\n\r\n        this._stopCamera();\r\n        document.getElementById(\"camera-container\").hidden = true;\r\n      },\r\n      \"image/jpeg\",\r\n      0.85\r\n    );\r\n  }\r\n\r\n  _handleFileSelect(event) {\r\n    const file = event.target.files[0];\r\n    if (!file.type.match(\"image.*\")) {\r\n      this.view.showError(\"File harus berupa gambar\");\r\n      return;\r\n    }\r\n\r\n    this.state.photoFile = file;\r\n    this.elements.photoPreview.src = URL.createObjectURL(file);\r\n    this.elements.photoPreview.hidden = false;\r\n  }\r\n\r\n  async _getCurrentLocation() {\r\n    try {\r\n      const position = await new Promise((resolve, reject) => {\r\n        navigator.geolocation.getCurrentPosition(resolve, reject, {\r\n          enableHighAccuracy: true,\r\n          timeout: 10000,\r\n        });\r\n      });\r\n\r\n      this._setLocation(position.coords.latitude, position.coords.longitude);\r\n    } catch (error) {\r\n      this.view.showError(\r\n        `Gagal mendapatkan lokasi: ${this._getGeoError(error)}`\r\n      );\r\n    }\r\n  }\r\n\r\n  _getGeoError(error) {\r\n    switch (error.code) {\r\n      case error.PERMISSION_DENIED:\r\n        return \"Izin lokasi ditolak\";\r\n      case error.POSITION_UNAVAILABLE:\r\n        return \"Lokasi tidak tersedia\";\r\n      case error.TIMEOUT:\r\n        return \"Waktu permintaan habis\";\r\n      default:\r\n        return \"Error tidak diketahui\";\r\n    }\r\n  }\r\n\r\n  _setLocation(lat, lon) {\r\n    this.elements.latInput.value = lat;\r\n    this.elements.lonInput.value = lon;\r\n\r\n    if (this.state.marker) {\r\n      this.state.marker.setLatLng([lat, lon]);\r\n    } else {\r\n      this.state.marker = L.marker([lat, lon]).addTo(this.state.map);\r\n    }\r\n\r\n    this.state.map.setView([lat, lon], 15);\r\n  }\r\n\r\n  _clearLocation() {\r\n    this.elements.latInput.value = \"\";\r\n    this.elements.lonInput.value = \"\";\r\n\r\n    if (this.state.marker) {\r\n      this.state.map.removeLayer(this.state.marker);\r\n      this.state.marker = null;\r\n    }\r\n  }\r\n\r\n  async _handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    const description = document.getElementById(\"description\").value.trim();\r\n    if (!description || !this.state.photoFile) {\r\n      this.view.showError(\"Deskripsi dan foto harus diisi\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"description\", description);\r\n      formData.append(\"photo\", this.state.photoFile);\r\n\r\n      if (this.elements.latInput.value && this.elements.lonInput.value) {\r\n        formData.append(\"lat\", this.elements.latInput.value);\r\n        formData.append(\"lon\", this.elements.lonInput.value);\r\n      }\r\n\r\n      const token = getAuthToken();\r\n      const response = token\r\n        ? await StoryAPI.addStory(formData, token)\r\n        : await StoryAPI.addStoryGuest(formData);\r\n\r\n      if (response.error) throw new Error(response.message);\r\n\r\n      if (Notification.permission === \"granted\") {\r\n        navigator.serviceWorker.ready.then((registration) => {\r\n          registration.showNotification(\"Laporan Terkirim\", {\r\n            body: \"Laporan Anda berhasil ditambahkan!\",\r\n            icon: \"/icons/icon-192x192.png\",\r\n            tag: \"laporan-baru\",\r\n            vibrate: [100, 50, 100],\r\n            data: {\r\n              dateOfArrival: Date.now(),\r\n              primaryKey: 1,\r\n            },\r\n          });\r\n        });\r\n      }\r\n\r\n      alert(\"Laporan berhasil ditambahkan!\");\r\n      window.location.hash = \"#/\";\r\n    } catch (error) {\r\n      this.view.showError(`Gagal mengirim: ${error.message}`);\r\n    } finally {\r\n      this._stopCamera();\r\n    }\r\n  }\r\n\r\n  async onPageRevisit() {\r\n    await this._setupDOMReferences();\r\n    if (this.state.map) {\r\n      this.state.map.invalidateSize();\r\n    }\r\n  }\r\n}\r\n","import AddStoryPresenter from \"./add-laporan-presenter\";\n\nexport default class AddStoryPage {\n  constructor() {\n    this.presenter = null;\n    this.container = null;\n    this.isFirstRender = true;\n  }\n\n  async render() {\n    this.container = document.createElement(\"div\");\n    this.container.innerHTML = `\n    <main id=\"mainContent\" tabindex=\"-1\">\n      <section class=\"container\" aria-labelledby=\"form-title\">\n        <h1 id=\"form-title\" style=\"text-align: center;\">Tambah Laporan Baru</h1>\n        \n        <form id=\"story-form\" class=\"story-form\" enctype=\"multipart/form-data\" aria-describedby=\"form-instructions\">   \n          <div role=\"alert\" id=\"error-message\" class=\"error-message\" hidden></div>\n          \n          <!-- Deskripsi -->\n          <div class=\"form-group\">\n            <label for=\"description\" class=\"form-label\">\n              Deskripsi Laporan <span class=\"required\">*</span>\n            </label>\n            <textarea \n              id=\"description\" \n              class=\"form-input\" \n              required\n              aria-required=\"true\"\n              placeholder=\"Masukkan deskripsi laporan Anda\"\n              rows=\"5\"\n            ></textarea>\n            <div id=\"description-help\" class=\"form-help\">Maksimal 500 karakter</div>\n          </div>\n          \n          <!-- Unggah Foto -->\n          <div class=\"form-group\">\n            <fieldset class=\"photo-upload\">\n              <legend>Unggah Foto</legend>\n              \n              <div class=\"photo-options\">\n                <div class=\"photo-option\">\n                  <label for=\"photo\" class=\"file-upload-label\">\n                    <span id=\"file-name\" class=\"file-name\">Belum ada file dipilih</span>\n                    <input type=\"file\" id=\"photo\" accept=\"image/*\" capture=\"environment\">\n                  </label>\n                </div>\n                \n                <div class=\"photo-or\">atau</div>\n                <div class=\"photo-option\">\n                <button type=\"button\" id=\"open-camera\" class=\"camera-button\">\n                  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\">\n                    <path d=\"M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z\" fill=\"currentColor\"/>\n                    <path d=\"M20 4H16.83L15.59 2.65C15.22 2.24 14.68 2 14.12 2H9.88C9.32 2 8.78 2.24 8.4 2.65L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z\" fill=\"currentColor\"/>\n                  </svg>\n                  Ambil Foto\n                </button>\n              </div>\n                  <select id=\"camera-select\" class=\"camera-select\" aria-label=\"Pilih kamera\">\n                    <option value=\"\">Pilih Kamera...</option>\n                  </select>\n                </div>\n              </div>\n              \n              <div id=\"camera-container\" hidden>\n                <video id=\"camera-preview\" width=\"300\" height=\"200\" style=\"display: block; margin: 0 auto; border: 1px solid gray;\" playsinline></video>\n                <div class=\"camera-controls\">\n                  <button type=\"button\" id=\"capture-photo\">Ambil Foto</button>\n                  <button type=\"button\" id=\"close-camera\">Tutup Kamera</button>\n                </div>\n              </div>\n              \n              <canvas id=\"photo-canvas\" hidden></canvas>\n              <img id=\"photo-preview\" class=\"photo-preview\" hidden>\n            </fieldset>\n          </div>\n          \n          <!-- Peta dan Lokasi -->\n          <div class=\"form-group\">\n            <div class=\"location-fieldset\">\n              <legend class=\"form-label\">Lokasi (Opsional)</legend>\n              \n              <div id=\"map\" class=\"location-map\" tabindex=\"0\" aria-label=\"Peta untuk memilih lokasi laporan\"></div>\n              \n              <div class=\"location-controls\">\n                <button \n                  type=\"button\" \n                  id=\"get-location\" \n                  class=\"location-button\"\n                  aria-label=\"Gunakan lokasi saat ini\"\n                >\n                  <svg aria-hidden=\"true\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z\"/>\n                  </svg>\n                  Gunakan Lokasi Saat Ini\n                </button>\n                \n                <button \n                  type=\"button\" \n                  id=\"clear-location\" \n                  class=\"location-button secondary\"\n                  aria-label=\"Hapus lokasi yang dipilih\"\n                >\n                  <svg aria-hidden=\"true\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\">\n                    <path fill=\"currentColor\" d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\n                  </svg>\n                  Hapus Lokasi\n                </button>\n              </div>\n              \n              <div class=\"location-coordinates\">\n                <label for=\"lat\" class=\"coordinate-label\">Latitude:</label>\n                <input \n                  type=\"text\" \n                  id=\"lat\" \n                  class=\"coordinate-input\"\n                  step=\"any\"\n                  aria-label=\"Latitude\"\n                  placeholder=\"-6.123456\"\n                >\n                \n                <label for=\"lon\" class=\"coordinate-label\">Longitude:</label>\n                <input \n                  type=\"text\" \n                  id=\"lon\" \n                  class=\"coordinate-input\"\n                  step=\"any\"\n                  aria-label=\"Longitude\"\n                  placeholder=\"106.123456\"\n                >\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"form-actions\">\n            <button type=\"submit\" style=\"border: none;\" class=\"cta-button\">\n              Kirim Laporan\n            </button>\n            <a href=\"#/\" class=\"cta-button secondary\">Batal</a>\n          </div>\n        </form>\n      </section>\n</main>\n\n    `;\n\n    return this.container;\n  }\n\n  async afterRender() {\n    const skipLink = document.querySelector(\".skip-link\");\n    if (skipLink) {\n      skipLink.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        const focusTarget =\n          document.getElementById(\"description\") ||\n          document.querySelector(\"main\");\n        if (focusTarget) {\n          focusTarget.setAttribute(\"tabindex\", \"-1\");\n          focusTarget.focus();\n        }\n      });\n    }\n\n    if (this.isFirstRender) {\n      this.presenter = new AddStoryPresenter(this);\n      await this.presenter.init();\n      this.isFirstRender = false;\n    } else {\n      await this.presenter.onPageRevisited();\n    }\n  }\n\n  showError(message) {\n    const errorElement = this.container.querySelector(\"#error-message\");\n    if (errorElement) {\n      errorElement.textContent = message;\n      errorElement.hidden = false;\n      errorElement.focus();\n    }\n  }\n\n  clearError() {\n    const errorElement = this.container.querySelector(\"#error-message\");\n    if (errorElement) {\n      errorElement.hidden = true;\n      errorElement.textContent = \"\";\n    }\n  }\n}\n","import { StoryAPI } from \"../../data/api\";\r\n\r\nexport default class DetailPresenter {\r\n  constructor(view) {\r\n    this.view = view;\r\n    this.storyAPI = StoryAPI;\r\n  }\r\n\r\n  handleSkipLink() {\r\n    const skipLink = document.querySelector(\".skip-link\");\r\n    if (skipLink) {\r\n      skipLink.addEventListener(\"click\", (e) => {\r\n        e.preventDefault();\r\n        const focusTarget = document.getElementById(\"mainContent\");\r\n        if (focusTarget) {\r\n          focusTarget.setAttribute(\"tabindex\", \"-1\");\r\n          focusTarget.focus();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  async loadStoryDetail(id) {\r\n    try {\r\n      const { story } = await this.storyAPI.getStoryDetail(id);\r\n      this.view.showStoryDetail({\r\n        name: story.name,\r\n        description: story.description,\r\n        photoUrl: story.photoUrl,\r\n        createdAt: story.createdAt,\r\n        lat: story.lat,\r\n        lon: story.lon,\r\n      });\r\n    } catch (error) {\r\n      this.view.showError(error.message);\r\n    }\r\n  }\r\n}\r\n","import animationData from \"../../../public/animations/404.json\";\r\nimport lottie from \"lottie-web\";\r\n\r\nexport default class NotFoundPage {\r\n  async render() {\r\n    return `\r\n      <div id=\"not-found-container\" style=\"text-align: center; padding: 2rem;\">\r\n        <div id=\"not-found-animation\" style=\"width: 300px; margin: auto;\"></div>\r\n        <h2>Oops! Halaman tidak ditemukan.</h2>\r\n        <a href=\"#/\">Kembali ke Beranda</a>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  async afterRender() {\r\n    lottie.loadAnimation({\r\n      container: document.getElementById(\"not-found-animation\"),\r\n      renderer: \"svg\",\r\n      loop: true,\r\n      autoplay: true,\r\n      animationData: animationData,\r\n    });\r\n  }\r\n}\r\n","import StoryIDB from \"../../data/story-idb\";\r\n\r\nexport default class BookmarkPage {\r\n  constructor() {\r\n    this.container = null;\r\n  }\r\n\r\n  async render() {\r\n    const el = document.createElement(\"div\");\r\n    el.innerHTML = `\r\n      <main id=\"mainContent\" tabindex=\"-1\">\r\n        <section class=\"container\">\r\n          <h1 style=\"text-align:center;\">Laporan yang Disimpan</h1>\r\n          <div id=\"bookmarked-stories\" class=\"stories-grid\"></div>\r\n        </section>\r\n      </main>\r\n    `;\r\n    this.container = el;\r\n    return el;\r\n  }\r\n\r\n  async afterRender() {\r\n    const container = this.container.querySelector(\"#bookmarked-stories\");\r\n    const stories = await StoryIDB.getAllBookmarks();\r\n\r\n    if (stories.length === 0) {\r\n      container.innerHTML = `<p>Tidak ada laporan yang disimpan.</p>`;\r\n      return;\r\n    }\r\n\r\n    container.innerHTML = stories\r\n      .map(\r\n        (story) => `\r\n      <div class=\"story-card\">\r\n        <img src=\"${story.photoUrl}\" alt=\"${story.name}\" class=\"story-img\"/>\r\n        <div class=\"story-content\">\r\n          <div class=\"story-text\">\r\n            <h3>${story.name}</h3>\r\n            <p>${story.description}</p>\r\n            <small>${new Date(story.createdAt).toLocaleString()}</small>\r\n          </div>\r\n          <div class=\"story-actions\">\r\n            <a href=\"#/detail/${story.id}\" class=\"cta-button\">Lihat Detail</a>\r\n            <button  class=\"notif remove-bookmark-btn\" data-id=\"${\r\n              story.id\r\n            }\">❌ Hapus</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `\r\n      )\r\n      .join(\"\");\r\n\r\n    container.querySelectorAll(\".remove-bookmark-btn\").forEach((btn) => {\r\n      const id = btn.dataset.id;\r\n      btn.addEventListener(\"click\", async () => {\r\n        await StoryIDB.deleteBookmark(id);\r\n        this.afterRender();\r\n        // Refresh\r\n      });\r\n    });\r\n  }\r\n}\r\n","import HomePage from \"../pages/home/home-page\";\nimport LaporanPage from \"../pages/laporan/laporan-page\";\nimport AddLaporanPage from \"../pages/addlaporan/add-laporan-page\";\nimport LoginPage from \"../pages/auth/login/login-page\";\nimport RegisterPage from \"../pages/auth/register/register-page\";\nimport DetailPage from \"../pages/detail/detail-page\";\nimport NotFoundPage from \"../pages/error/404\";\nimport BookmarkPage from \"../pages/bookmark/bookmark-page\";\n\nimport {\n  checkAuthenticatedRoute,\n  checkUnauthenticatedRouteOnly,\n} from \"../utils/auth\";\n\nconst routes = {\n  \"/\": () => checkAuthenticatedRoute(new HomePage()),\n  \"/laporan\": () => checkAuthenticatedRoute(new LaporanPage()),\n  \"/bookmark\": () => checkAuthenticatedRoute(new BookmarkPage()),\n  \"/detail/:id\": checkAuthenticatedRoute(new DetailPage()),\n  \"/addLaporan\": () => new AddLaporanPage(),\n\n  \"/login\": () => checkUnauthenticatedRouteOnly(new LoginPage()),\n  \"/register\": () => checkUnauthenticatedRouteOnly(new RegisterPage()),\n\n  \"*\": () => new NotFoundPage(),\n\n  \"/404\": () => new NotFoundPage(),\n};\n\nexport default routes;\n","import DetailPresenter from \"./detail-presenter.js\";\r\n\r\nexport default class DetailPage {\r\n  constructor() {\r\n    this.presenter = new DetailPresenter(this);\r\n  }\r\n\r\n  async render() {\r\n    const container = document.createElement(\"div\");\r\n    container.innerHTML = `\r\n      <main id=\"mainContent\" tabindex=\"-1\">\r\n        <section class=\"container\">\r\n          <h1>Detail Laporan</h1>\r\n          <div id=\"story-detail\" class=\"story-detail\"></div>\r\n        </section>\r\n      </main>\r\n    `;\r\n    return container;\r\n  }\r\n\r\n  async afterRender() {\r\n    const hash = window.location.hash;\r\n    const id = hash.split(\"/\")[2];\r\n    this.presenter.handleSkipLink();\r\n    await this.presenter.loadStoryDetail(id);\r\n  }\r\n\r\n  showStoryDetail(story) {\r\n    const detailContainer = document.getElementById(\"story-detail\");\r\n    detailContainer.innerHTML = `\r\n      <div class=\"story-card\">\r\n        <img src=\"${story.photoUrl}\" alt=\"${story.name}\" class=\"story-img\"/>\r\n        <div class=\"story-content\">\r\n          <h2>${story.name}</h2>\r\n          <p>${story.description}</p>\r\n          <small>Dibuat pada: ${new Date(\r\n            story.createdAt\r\n          ).toLocaleString()}</small>\r\n          ${\r\n            story.lat && story.lon\r\n              ? `<p>Lokasi: ${story.lat}, ${story.lon}</p>`\r\n              : \"\"\r\n          }\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  showError(message) {\r\n    const detailContainer = document.getElementById(\"story-detail\");\r\n    detailContainer.innerHTML = `<p class=\"error\">Gagal memuat detail: ${message}</p>`;\r\n  }\r\n}\r\n","function extractPathnameSegments(path) {\n  const splitUrl = path.split(\"/\");\n\n  return {\n    resource: splitUrl[1] || null,\n    id: splitUrl[2] || null,\n  };\n}\n\nfunction constructRouteFromSegments(pathSegments) {\n  let pathname = \"\";\n\n  if (pathSegments.resource) {\n    pathname = pathname.concat(`/${pathSegments.resource}`);\n  }\n\n  if (pathSegments.id) {\n    pathname = pathname.concat(\"/:id\");\n  }\n\n  return pathname || \"/\";\n}\n\nexport function getActivePathname() {\n  return location.hash.replace(\"#\", \"\") || \"/\";\n}\n\nexport function getActiveRoute() {\n  const pathname = getActivePathname();\n  const urlSegments = extractPathnameSegments(pathname);\n  return constructRouteFromSegments(urlSegments);\n}\n\nexport function parseActivePathname() {\n  const pathname = getActivePathname();\n  return extractPathnameSegments(pathname);\n}\n\nexport function getRoute(pathname) {\n  const urlSegments = extractPathnameSegments(pathname);\n  return constructRouteFromSegments(urlSegments);\n}\n\nexport function parsePathname(pathname) {\n  return extractPathnameSegments(pathname);\n}\n","import CONFIG from \"../config\";\r\nimport { getAuthToken } from \"./auth\";\r\n\r\n// Helper untuk konversi VAPID key\r\nfunction urlBase64ToUint8Array(base64String) {\r\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\r\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n\r\n  const rawData = window.atob(base64);\r\n  const outputArray = new Uint8Array(rawData.length);\r\n\r\n  for (let i = 0; i < rawData.length; ++i) {\r\n    outputArray[i] = rawData.charCodeAt(i);\r\n  }\r\n  return outputArray;\r\n}\r\n\r\n// Cek dukungan browser\r\nexport function isPushSupported() {\r\n  return \"PushManager\" in window && \"serviceWorker\" in navigator;\r\n}\r\n\r\n// Meminta izin notifikasi\r\nexport async function requestNotificationPermission() {\r\n  try {\r\n    const permission = await Notification.requestPermission();\r\n    return permission === \"granted\";\r\n  } catch (error) {\r\n    console.error(\"Error requesting notification permission:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Dapatkan subscription saat ini\r\nexport async function getCurrentSubscription() {\r\n  if (!isPushSupported()) return null;\r\n\r\n  const registration = await navigator.serviceWorker.ready;\r\n  return registration.pushManager.getSubscription();\r\n}\r\n\r\n// Subscribe user ke push notification\r\nexport async function subscribeUser() {\r\n  try {\r\n    // Validasi environment\r\n    if (!isPushSupported()) {\r\n      throw new Error(\"Browser tidak mendukung Push Notification\");\r\n    }\r\n\r\n    // Dapatkan registration\r\n    const registration = await navigator.serviceWorker.ready;\r\n\r\n    // Cek subscription yang ada\r\n    let subscription = await registration.pushManager.getSubscription();\r\n\r\n    // Jika sudah subscribe, gunakan yang ada\r\n    if (subscription) {\r\n      return subscription;\r\n    }\r\n\r\n    // Buat subscription baru\r\n    const convertedVapidKey = urlBase64ToUint8Array(CONFIG.VAPID_PUBLIC_KEY);\r\n    subscription = await registration.pushManager.subscribe({\r\n      userVisibleOnly: true,\r\n      applicationServerKey: convertedVapidKey,\r\n    });\r\n\r\n    // Validasi subscription\r\n    if (!subscription || !subscription.endpoint) {\r\n      throw new Error(\"Gagal membuat subscription\");\r\n    }\r\n\r\n    // Kirim ke server\r\n    await sendSubscriptionToServer(subscription);\r\n\r\n    return subscription;\r\n  } catch (error) {\r\n    console.error(\"Error subscribing user:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Helper untuk ekstrak keys dari FCM\r\nasync function extractKeysFromFCM(subscription) {\r\n  try {\r\n    // Untuk FCM, kita mungkin perlu mengurai endpoint untuk mendapatkan keys\r\n    const endpointParts = subscription.endpoint.split(\"/\");\r\n    const subscriptionId = endpointParts[endpointParts.length - 1];\r\n\r\n    return {\r\n      p256dh: subscriptionId,\r\n      auth: crypto.getRandomValues(new Uint8Array(16)).join(\"\"),\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Failed to extract keys from FCM:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\n// Unsubscribe user dari push notification\r\nexport async function unsubscribeUser() {\r\n  try {\r\n    // 1. Dapatkan subscription saat ini\r\n    const subscription = await getCurrentSubscription();\r\n\r\n    if (!subscription) {\r\n      console.log(\"No active subscription found\");\r\n      return true;\r\n    }\r\n\r\n    // 2. Unsubscribe dari push service\r\n    const successfullyUnsubscribed = await subscription.unsubscribe();\r\n\r\n    if (successfullyUnsubscribed) {\r\n      // 3. Hapus dari server\r\n      await deleteSubscriptionFromServer(subscription.endpoint);\r\n\r\n      // 4. Hapus dari localStorage\r\n      localStorage.removeItem(\"pushSubscription\");\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  } catch (error) {\r\n    console.error(\"Error unsubscribing user:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Helper: Kirim subscription ke server\r\nasync function sendSubscriptionToServer(subscription) {\r\n  try {\r\n    // Validasi subscription dan keys\r\n    if (!subscription || !subscription.endpoint) {\r\n      throw new Error(\"Invalid subscription object\");\r\n    }\r\n\r\n    // Pastikan keys ada, jika tidak coba ekstrak dari options\r\n    const keys = subscription.keys || {};\r\n    const p256dh = keys.p256dh || extractP256dhKey(subscription);\r\n    const auth = keys.auth || extractAuthKey(subscription);\r\n\r\n    if (!p256dh || !auth) {\r\n      throw new Error(\"Missing required subscription keys\");\r\n    }\r\n\r\n    const response = await fetch(`${CONFIG.BASE_URL}/notifications/subscribe`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${getAuthToken()}`,\r\n      },\r\n      body: JSON.stringify({\r\n        endpoint: subscription.endpoint,\r\n        keys: {\r\n          p256dh: p256dh,\r\n          auth: auth,\r\n        },\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      throw new Error(errorData.message || \"Failed to send subscription\");\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(\"Error sending subscription:\", {\r\n      error: error.message,\r\n      subscription: subscription,\r\n    });\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Helper functions untuk ekstrak keys jika tidak tersedia langsung\r\nfunction extractP256dhKey(subscription) {\r\n  // Coba ekstrak dari endpoint FCM\r\n  if (subscription.endpoint.includes(\"fcm.googleapis.com\")) {\r\n    const endpointParts = subscription.endpoint.split(\"/\");\r\n    return endpointParts[endpointParts.length - 1];\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction extractAuthKey(subscription) {\r\n  // Generate random auth token jika tidak tersedia\r\n  return crypto.getRandomValues(new Uint8Array(16)).join(\"\");\r\n}\r\n// Helper: Hapus subscription dari server\r\nasync function deleteSubscriptionFromServer(endpoint) {\r\n  try {\r\n    const response = await fetch(`${CONFIG.BASE_URL}/notifications/subscribe`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: `Bearer ${getAuthToken()}`,\r\n      },\r\n      body: JSON.stringify({ endpoint }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(\"Failed to delete subscription\");\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error(\"Error deleting subscription:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Di akhir notif.js\r\nexport async function initializePushNotifications() {\r\n  try {\r\n    if (!isPushSupported()) {\r\n      console.log(\"Push notifications not supported\");\r\n      return false;\r\n    }\r\n\r\n    const registration = await navigator.serviceWorker.ready;\r\n    let subscription = await registration.pushManager.getSubscription();\r\n\r\n    if (subscription) {\r\n      // Cek dan perbaiki keys jika perlu\r\n      if (!subscription.keys) {\r\n        subscription = await recreateSubscription(registration);\r\n      }\r\n      await sendSubscriptionToServer(subscription);\r\n      return true;\r\n    }\r\n    return false;\r\n  } catch (error) {\r\n    console.error(\"Error initializing push notifications:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function recreateSubscription(registration) {\r\n  const existingSubscription = await registration.pushManager.getSubscription();\r\n  if (existingSubscription) {\r\n    await existingSubscription.unsubscribe(); // Perbaikan di sini\r\n  }\r\n  const convertedVapidKey = urlBase64ToUint8Array(CONFIG.VAPID_PUBLIC_KEY);\r\n  return await registration.pushManager.subscribe({\r\n    userVisibleOnly: true,\r\n    applicationServerKey: convertedVapidKey,\r\n  });\r\n}\r\n","import routes from \"../routes/routes\";\nimport { getActiveRoute } from \"../routes/url-parser\";\nimport { isAuthenticated, removeAuthToken, getAuthToken } from \"../utils/auth\";\nimport CONFIG from \"../config\";\nimport NotFoundPage from \"../pages/error/404\";\n\nimport {\n  isPushSupported,\n  requestNotificationPermission,\n  subscribeUser,\n  unsubscribeUser,\n  getCurrentSubscription,\n  initializePushNotifications,\n} from \"../utils/notif\";\n\nfunction renderIcon(iconFn, size = 20) {\n  return iconFn({ size, strokeWidth: 1.5, color: \"currentColor\" });\n}\n\nconsole.log(\"Current permission:\", Notification.permission);\nconsole.log(\"CONFIG:\", CONFIG);\nconsole.log(\"VAPID Key:\", CONFIG.VAPID_PUBLIC_KEY);\n\nclass App {\n  #content = null;\n  #drawerButton = null;\n  #navigationDrawer = null;\n\n  constructor({ navigationDrawer, drawerButton, content }) {\n    this.#content = content;\n    this.#drawerButton = drawerButton;\n    this.#navigationDrawer = navigationDrawer;\n    this._setupRouter = this._setupRouter.bind(this);\n    this._renderPageContent = this._renderPageContent.bind(this);\n    this._deferredPrompt = null;\n\n    this._setupDrawer();\n    this.updateAuthMenu();\n\n    this._setupRouter();\n    this._initializePushNotifications();\n    this._setupInstallPrompt();\n\n    window.addEventListener(\"authChange\", () => this.updateAuthMenu());\n  }\n\n  _setupInstallPrompt() {\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n\n      this._deferredPrompt = e;\n\n      if (!document.getElementById(\"install-button\")) {\n        this._showInstallButton();\n      }\n    });\n  }\n\n  _showInstallButton() {\n    const installButton = document.createElement(\"button\");\n    installButton.id = \"install-button\";\n    installButton.className = \"install-button\";\n    installButton.innerHTML =\n      '<i class=\"fas fa-download\"></i> Install Flowater';\n\n    installButton.addEventListener(\"click\", this._installApp.bind(this));\n    document.body.appendChild(installButton);\n  }\n\n  async _installApp() {\n    if (!this._deferredPrompt) return;\n\n    this._deferredPrompt.prompt();\n\n    const { outcome } = await this._deferredPrompt.userChoice;\n    console.log(\n      `User ${\n        outcome === \"accepted\" ? \"accepted\" : \"dismissed\"\n      } the install prompt`\n    );\n\n    this._deferredPrompt = null;\n\n    const button = document.getElementById(\"install-button\");\n    if (button) button.remove();\n  }\n\n  _setupRouter() {\n    const handleNavigation = async () => {\n      const url = getActiveRoute();\n      try {\n        if (document.startViewTransition) {\n          await document.startViewTransition(() => this._renderPageContent(url))\n            .finished;\n        } else {\n          await this._renderPageContent(url);\n        }\n      } catch (error) {\n        console.error(\"Navigation error:\", error);\n        window.location.hash = \"#/\";\n      }\n    };\n\n    handleNavigation();\n    window.addEventListener(\"hashchange\", handleNavigation);\n  }\n\n  async _renderPageContent(url) {\n    try {\n      const routePath = getActiveRoute();\n\n      const pageResolver = routes[routePath] || routes[\"*\"];\n      const page =\n        typeof pageResolver === \"function\" ? pageResolver() : pageResolver;\n\n      this.#content.innerHTML = \"\";\n      const renderedContent = await page.render();\n      this.#content.appendChild(renderedContent);\n\n      if (page.afterRender) {\n        await page.afterRender();\n      }\n    } catch (error) {\n      const notFoundPage = new NotFoundPage();\n      this.#content.innerHTML = await notFoundPage.render();\n      await notFoundPage.afterRender();\n    }\n  }\n\n  _setupDrawer() {\n    this.#drawerButton.addEventListener(\"click\", () => {\n      this.#navigationDrawer.classList.toggle(\"open\");\n    });\n\n    document.body.addEventListener(\"click\", (event) => {\n      if (\n        !this.#navigationDrawer.contains(event.target) &&\n        !this.#drawerButton.contains(event.target)\n      ) {\n        this.#navigationDrawer.classList.remove(\"open\");\n      }\n\n      this.#navigationDrawer.querySelectorAll(\"a\").forEach((link) => {\n        if (link.contains(event.target)) {\n          this.#navigationDrawer.classList.remove(\"open\");\n        }\n      });\n    });\n  }\n\n  updateAuthMenu() {\n    const navList = document.getElementById(\"nav-list\");\n    if (!navList) return;\n\n    const isAuth = isAuthenticated();\n\n    const menuItems = isAuth\n      ? [\n          '<li><a href=\"#/\">Beranda</a></li>',\n          '<li><a href=\"#/laporan\">List Laporan</a></li>',\n          '<li><a href=\"#/bookmark\">Disimpan</a></li>',\n          '<li><a href=\"#/addLaporan\">Tambah Laporan</a></li>',\n          '<li><button id=\"notif-button\" class=\"notif\">Memuat Status Notifikasi...</button></li>',\n\n          `<li><a href=\"#\" class=\"cta-button\">Logout</a></li>`,\n        ]\n      : [\n          '<li><a href=\"#/addLaporan\">Tambah Laporan</a></li>',\n          '<li><a href=\"#/login\" class=\"cta-button\">Login</a></li>',\n        ];\n\n    navList.innerHTML = menuItems.join(\"\");\n\n    // Notification button\n    if (isAuth) {\n      this._updateNotificationButton();\n    }\n\n    // Logout\n    if (isAuth) {\n      const logoutButton = navList.querySelector(\".cta-button\");\n      logoutButton.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        removeAuthToken();\n        window.dispatchEvent(new Event(\"authChange\"));\n        window.location.hash = \"#/login\";\n      });\n    }\n  }\n\n  // ----------Notification----------\n\n  async _initializePushNotifications() {\n    try {\n      const token = getAuthToken();\n\n      if (!token || typeof token !== \"string\" || !token.startsWith(\"Bearer \")) {\n        console.log(\n          \"Jika User belum login, maka tidak menjalankan push notification\"\n        );\n        return;\n      }\n\n      console.log(\"Memulai inisialisasi push notification...\");\n      const success = await initializePushNotifications();\n\n      if (!success) {\n        console.log(\n          \"Push notification tidak diaktifkan (browser tidak support atau tidak ada subscription)\"\n        );\n      }\n    } catch (error) {\n      console.error(\"Gagal menginisialisasi push notification:\", error.message);\n    }\n  }\n\n  async _handlePushNotification() {\n    try {\n      if (!isAuthenticated()) {\n        throw new Error(\"Anda harus login terlebih dahulu\");\n      }\n\n      if (!isPushSupported()) {\n        throw new Error(\"Browser tidak mendukung Push Notification\");\n      }\n\n      const permission = await Notification.requestPermission();\n      if (permission !== \"granted\") {\n        throw new Error(\"Izin notifikasi ditolak\");\n      }\n\n      const registration = await navigator.serviceWorker.ready;\n\n      const subscription = await subscribeUser();\n      console.log(\"Subscription berhasil:\", subscription);\n\n      alert(\"Notifikasi berhasil diaktifkan!\");\n    } catch (error) {\n      console.error(\"Error:\", error);\n      alert(`Gagal mengaktifkan notifikasi: ${error.message}`);\n    }\n  }\n\n  async _updateNotificationButton() {\n    const notifButton = document.getElementById(\"notif-button\");\n    if (!notifButton) return;\n\n    try {\n      const isSubscribed = await this._checkSubscriptionStatus();\n\n      if (isSubscribed) {\n        notifButton.textContent = \"Unsubscribe Notifikasi\";\n        notifButton.onclick = async () => {\n          await this._unsubscribeFromNotifications();\n          this._updateNotificationButton();\n        };\n      } else {\n        notifButton.textContent = \"Subscribe Notifikasi\";\n        notifButton.onclick = async () => {\n          await this._subscribeToNotifications();\n          this._updateNotificationButton();\n        };\n      }\n    } catch (error) {\n      console.error(\"Error updating notification button:\", error);\n      notifButton.textContent = \"Error - Coba Lagi\";\n      notifButton.onclick = async () => {\n        await this._handlePushNotification();\n        this._updateNotificationButton();\n      };\n    }\n  }\n\n  async _subscribeToNotifications() {\n    try {\n      const granted = await requestNotificationPermission();\n      if (!granted) {\n        alert(\"Izin notifikasi diperlukan untuk fitur ini\");\n        return;\n      }\n\n      await subscribeUser();\n      alert(\"Notifikasi berhasil diaktifkan\");\n      this.setupPushNotification();\n    } catch (error) {\n      alert(`Gagal mengaktifkan: ${error.message}`);\n    }\n  }\n\n  async _unsubscribeFromNotifications() {\n    try {\n      await unsubscribeUser();\n      alert(\"Notifikasi berhasil dimatikan\");\n      this.setupPushNotification();\n    } catch (error) {\n      alert(`Gagal mematikan: ${error.message}`);\n    }\n  }\n\n  async _checkSubscriptionStatus() {\n    if (!isPushSupported()) return false;\n\n    const registration = await navigator.serviceWorker.ready;\n    const subscription = await registration.pushManager.getSubscription();\n    return !!subscription;\n  }\n\n  async setupPushNotification() {\n    if (!isPushSupported()) {\n      console.log(\"Browser tidak mendukung Push Notification\");\n      return;\n    }\n\n    const notificationButton = document.getElementById(\"notification-button\");\n    if (!notificationButton) return;\n\n    const subscription = await getCurrentSubscription();\n\n    if (subscription) {\n      notificationButton.textContent = \"Nonaktifkan Notifikasi\";\n      notificationButton.onclick = this.handleUnsubscribe.bind(this);\n    } else {\n      notificationButton.textContent = \"Aktifkan Notifikasi\";\n      notificationButton.onclick = this.handleSubscribe.bind(this);\n    }\n  }\n\n  async handleSubscribe() {\n    try {\n      const granted = await requestNotificationPermission();\n      if (!granted) {\n        alert(\"Izin notifikasi diperlukan untuk fitur ini\");\n        return;\n      }\n\n      await subscribeUser();\n      alert(\"Notifikasi berhasil diaktifkan\");\n      this.setupPushNotification();\n    } catch (error) {\n      alert(`Gagal mengaktifkan: ${error.message}`);\n    }\n  }\n\n  async handleUnsubscribe() {\n    try {\n      await unsubscribeUser();\n      alert(\"Notifikasi berhasil dimatikan\");\n      this.setupPushNotification();\n    } catch (error) {\n      alert(`Gagal mematikan: ${error.message}`);\n    }\n  }\n\n  async renderPage() {\n    return this._renderPageContent(getActiveRoute());\n  }\n}\nexport default App;\n","// CSS imports\nimport \"../styles/styles.css\";\nimport \"@fortawesome/fontawesome-free/css/all.min.css\";\nimport App from \"./pages/app\";\n\nasync function initializeApp() {\n  const app = new App({\n    content: document.querySelector(\"#main-content\"),\n    drawerButton: document.querySelector(\"#drawer-button\"),\n    navigationDrawer: document.querySelector(\"#navigation-drawer\"),\n  });\n\n  await app.renderPage();\n\n  window.addEventListener(\"hashchange\", async () => {\n    await app.renderPage();\n  });\n\n  // Inisialisasi halaman login jika ada\n  if (document.getElementById(\"login-form\")) {\n    const { default: LoginPage } = await import(\n      \"./pages/auth/login/login-page\"\n    );\n    const { default: LoginPresenter } = await import(\n      \"./pages/auth/login/login-presenter\"\n    );\n    const loginPage = new LoginPage();\n    await loginPage.render();\n    await loginPage.afterRender();\n    new LoginPresenter(loginPage);\n  }\n\n  // Inisialisasi halaman register jika ada\n  if (document.getElementById(\"register-form\")) {\n    const { default: RegisterPage } = await import(\n      \"./pages/auth/register/register-page\"\n    );\n    const { default: RegisterPresenter } = await import(\n      \"./pages/auth/register/register-presenter\"\n    );\n    const registerPage = new RegisterPage();\n    await registerPage.render();\n    await registerPage.afterRender();\n    new RegisterPresenter(registerPage);\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  initializeApp().catch(console.error);\n});\n\nif (\"serviceWorker\" in navigator) {\n  window.addEventListener(\"load\", async () => {\n    try {\n      const registration = await navigator.serviceWorker.register(\"/sw.js\");\n\n      // Periksa update\n      registration.addEventListener(\"updatefound\", () => {\n        const newWorker = registration.installing;\n        newWorker.addEventListener(\"statechange\", () => {\n          if (newWorker.state === \"activated\") {\n            console.log(\"Service Worker ready to handle offline requests\");\n          }\n        });\n      });\n    } catch (error) {\n      console.error(\"Service Worker registration failed:\", error);\n    }\n  });\n}\n","class LoadingIndicator extends HTMLElement {\r\n  constructor() {\r\n    super();\r\n    this.attachShadow({ mode: \"open\" });\r\n  }\r\n\r\n  connectedCallback() {\r\n    this.shadowRoot.innerHTML = `\r\n        <style>\r\n          .loading-container {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background-color: rgba(0,0,0,0.5);\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            z-index: 9999;\r\n          }\r\n          \r\n          .container {\r\n            --uib-size: 45px;\r\n            --uib-color: #9dceff; \r\n            --uib-speed: 1.75s;\r\n            display: flex;\r\n            align-items: flex-end;\r\n            padding-bottom: 20%;\r\n            justify-content: space-between;\r\n            width: var(--uib-size);\r\n            height: calc(var(--uib-size) * 0.6);\r\n          }\r\n          \r\n          .cube {\r\n            flex-shrink: 0;\r\n            width: calc(var(--uib-size) * 0.2);\r\n            height: calc(var(--uib-size) * 0.2);\r\n            animation: jump var(--uib-speed) ease-in-out infinite;\r\n          }\r\n          \r\n          .cube__inner {\r\n            display: block;\r\n            height: 100%;\r\n            width: 100%;\r\n            border-radius: 25%;\r\n            background-color: var(--uib-color);\r\n            transform-origin: center bottom;\r\n            animation: morph var(--uib-speed) ease-in-out infinite;\r\n            transition: background-color 0.3s ease;\r\n          }\r\n          \r\n          .cube:nth-child(2) {\r\n            animation-delay: calc(var(--uib-speed) * -0.36);\r\n          }\r\n          \r\n          .cube:nth-child(2) .cube__inner {\r\n            animation-delay: calc(var(--uib-speed) * -0.36);\r\n          }\r\n          \r\n          .cube:nth-child(3) {\r\n            animation-delay: calc(var(--uib-speed) * -0.2);\r\n          }\r\n          \r\n          .cube:nth-child(3) .cube__inner {\r\n            animation-delay: calc(var(--uib-speed) * -0.2);\r\n          }\r\n          \r\n          @keyframes jump {\r\n            0% {\r\n              transform: translateY(0px);\r\n            }\r\n            30% {\r\n              transform: translateY(0px);\r\n              animation-timing-function: ease-out;\r\n            }\r\n            50% {\r\n              transform: translateY(-200%);\r\n              animation-timing-function: ease-in;\r\n            }\r\n            75% {\r\n              transform: translateY(0px);\r\n              animation-timing-function: ease-in;\r\n            }\r\n          }\r\n          \r\n          @keyframes morph {\r\n            0% {\r\n              transform: scaleY(1);\r\n            }\r\n            10% {\r\n              transform: scaleY(1);\r\n            }\r\n            20%, 25% {\r\n              transform: scaleY(0.6) scaleX(1.3);\r\n              animation-timing-function: ease-in-out;\r\n            }\r\n            30% {\r\n              transform: scaleY(1.15) scaleX(0.9);\r\n              animation-timing-function: ease-in-out;\r\n            }\r\n            40% {\r\n              transform: scaleY(1);\r\n            }\r\n            70%, 85%, 100% {\r\n              transform: scaleY(1);\r\n            }\r\n            75% {\r\n              transform: scaleY(0.8) scaleX(1.2);\r\n            }\r\n          }\r\n        </style>\r\n        <div class=\"loading-container\">\r\n          <div class=\"container\">\r\n            <div class=\"cube\"><div class=\"cube__inner\"></div></div>\r\n            <div class=\"cube\"><div class=\"cube__inner\"></div></div>\r\n            <div class=\"cube\"><div class=\"cube__inner\"></div></div>\r\n          </div>\r\n        </div>\r\n      `;\r\n  }\r\n}\r\n\r\ncustomElements.define(\"loading-indicator\", LoadingIndicator);\r\n\r\nexport function showLoader() {\r\n  const loader = document.getElementById(\"global-loader\");\r\n  if (loader) loader.style.display = \"block\";\r\n}\r\n\r\nexport function hideLoader() {\r\n  const loader = document.getElementById(\"global-loader\");\r\n  if (loader) loader.style.display = \"none\";\r\n}\r\n","// config.js\nconst CONFIG = {\n  BASE_URL: \"https://story-api.dicoding.dev/v1\",\n  VAPID_PUBLIC_KEY:\n    \"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk\",\n};\n\nexport default CONFIG; // Pastikan menggunakan export default\n","import LoginPresenter from \"./login-presenter\";\r\n\r\nexport default class LoginPage {\r\n  async render() {\r\n    const container = document.createElement(\"div\");\r\n    container.innerHTML = `\r\n<main id=\"mainContent\" tabindex=\"-1\">\r\n  <article class=\"auth-container\" aria-labelledby=\"loginHeading\">\r\n    <h1 id=\"loginHeading\" style=\"text-align:center; margin-bottom:5px;\">Masuk</h1>\r\n\r\n    <form id=\"login-form\" aria-label=\"Login form\">\r\n      <div class=\"form-group\">\r\n        <label for=\"email\">Email</label>\r\n        <input \r\n          type=\"email\" \r\n          id=\"email\" \r\n          name=\"email\" \r\n          required\r\n          aria-required=\"true\"\r\n          autocomplete=\"email\"\r\n          placeholder=\"Masukkan email anda\"\r\n          tabindex=\"0\"\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"password\">Password</label>\r\n        <input \r\n          type=\"password\" \r\n          id=\"password\" \r\n          name=\"password\" \r\n          required\r\n          minlength=\"8\"\r\n          aria-required=\"true\"\r\n          autocomplete=\"current-password\"\r\n          placeholder=\"Masukkan password anda\"\r\n          tabindex=\"0\"\r\n        >\r\n      </div>\r\n\r\n      <div id=\"login-error\" class=\"error-message\" role=\"alert\" aria-live=\"assertive\" style=\"display: none;\"></div>\r\n\r\n      <button type=\"submit\" class=\"btn\" tabindex=\"0\">Masuk</button>\r\n    </form>\r\n\r\n    <p>Belum memiliki akun? <a href=\"#/register\" tabindex=\"0\">Daftar</a></p>\r\n  </article>\r\n</main>\r\n\r\n    `;\r\n    return container;\r\n  }\r\n\r\n  async afterRender() {\r\n    const skipLink = document.querySelector(\".skip-link\");\r\n    skipLink.addEventListener(\"click\", (e) => {\r\n      e.preventDefault();\r\n      document.getElementById(\"email\").focus();\r\n    });\r\n    new LoginPresenter(this);\r\n  }\r\n}\r\n","// auth.js\r\nexport const setAuthToken = (token) => {\r\n  localStorage.setItem(\"authToken\", token);\r\n  window.dispatchEvent(new Event(\"authChange\"));\r\n};\r\n\r\nexport function getAuthToken() {\r\n  // Cek di localStorage\r\n  const token = localStorage.getItem(\"authToken\");\r\n\r\n  // Validasi token\r\n  if (!token || token === \"undefined\" || token === \"null\") {\r\n    return null;\r\n  }\r\n\r\n  return token;\r\n}\r\n\r\nexport const removeAuthToken = () => {\r\n  localStorage.removeItem(\"authToken\");\r\n  window.dispatchEvent(new Event(\"authChange\"));\r\n};\r\n\r\nexport const isAuthenticated = () => {\r\n  return !!getAuthToken();\r\n};\r\n\r\nexport const checkAuthenticatedRoute = (page) => {\r\n  if (!isAuthenticated()) {\r\n    window.location.hash = \"#/login\";\r\n    return null;\r\n  }\r\n  return page;\r\n};\r\n\r\nexport const checkUnauthenticatedRouteOnly = (page) => {\r\n  if (isAuthenticated()) {\r\n    window.location.hash = \"#/\";\r\n    return null;\r\n  }\r\n  return page;\r\n};\r\n","import { AuthAPI } from \"../../../data/api\";\r\nimport { setAuthToken } from \"../../../utils/auth\";\r\nimport { showLoader, hideLoader } from \"../../../utils/loader\";\r\n\r\nexport default class RegisterPresenter {\r\n  constructor(view) {\r\n    this.view = view;\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.form = document.getElementById(\"register-form\");\r\n    this.errorElement = document.getElementById(\"register-error\");\r\n    this.bindEvents();\r\n  }\r\n\r\n  bindEvents() {\r\n    this.form.addEventListener(\"submit\", async (e) => {\r\n      e.preventDefault();\r\n      await this.handleRegister();\r\n    });\r\n  }\r\n\r\n  async handleRegister() {\r\n    const name = document.getElementById(\"name\").value;\r\n    const email = document.getElementById(\"email\").value;\r\n    const password = document.getElementById(\"password\").value;\r\n\r\n    this.clearErrors();\r\n\r\n    if (!name || !email || !password) {\r\n      this.showError(\"Silakan isi semua kolom\");\r\n      return;\r\n    }\r\n\r\n    if (password.length < 8) {\r\n      this.showError(\"Password minimal 8 karakter\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      showLoader();\r\n      const response = await AuthAPI.register({ name, email, password });\r\n\r\n      if (response.error) {\r\n        this.showError(response.message);\r\n      } else {\r\n        this.showSuccess(\"Register berhasil! Mengarahkan...\");\r\n        setTimeout(() => {\r\n          window.location.href = \"#/login\";\r\n        }, 1500);\r\n      }\r\n    } catch (error) {\r\n      this.showError(\"Registrasi gagal. Silakan coba lagi.\");\r\n      console.error(\"Proses Registrasi Gagal:\", error);\r\n    } finally {\r\n      hideLoader();\r\n    }\r\n  }\r\n\r\n  showError(message) {\r\n    this.errorElement.textContent = message;\r\n    this.errorElement.className = \"error-message error\";\r\n    this.errorElement.style.display = \"block\";\r\n    this.errorElement.focus();\r\n  }\r\n\r\n  showSuccess(message) {\r\n    this.errorElement.textContent = message;\r\n    this.errorElement.className = \"error-message success\";\r\n    this.errorElement.style.display = \"block\";\r\n  }\r\n\r\n  clearErrors() {\r\n    this.errorElement.style.display = \"none\";\r\n    this.errorElement.className = \"error-message\";\r\n  }\r\n}\r\n","import CONFIG from \"../config\";\nimport { getAuthToken } from \"../utils/auth\";\n\nconst ENDPOINTS = {\n  ENDPOINT: `${CONFIG.BASE_URL}`,\n};\n\nexport const StoryAPI = {\n  async getAllStories({ page = 1, size = 12, location = 0 } = {}) {\n    const response = await fetch(\n      `${ENDPOINTS.ENDPOINT}/stories?page=${page}&size=${size}&location=${location}`,\n      {\n        headers: {\n          Authorization: `Bearer ${getAuthToken()}`,\n        },\n      }\n    );\n    return response.json();\n  },\n\n  async getStoryDetail(id) {\n    const response = await fetch(`${ENDPOINTS.ENDPOINT}/stories/${id}`, {\n      headers: {\n        Authorization: `Bearer ${getAuthToken()}`,\n      },\n    });\n    return response.json();\n  },\n  async addStory(formData, token) {\n    const response = await fetch(`${ENDPOINTS.ENDPOINT}/stories`, {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n      body: formData,\n    });\n    return response.json();\n  },\n\n  async addStoryGuest(formData) {\n    const response = await fetch(`${ENDPOINTS.ENDPOINT}/stories/guest`, {\n      method: \"POST\",\n      body: formData,\n    });\n    return response.json();\n  },\n  async sendStoryNotification(storyId, notificationData) {\n    const response = await fetch(\n      `${ENDPOINTS.ENDPOINT}/stories/${storyId}/notify`,\n      {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${getAuthToken()}`,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(notificationData),\n      }\n    );\n    return response.json();\n  },\n};\n\nexport const AuthAPI = {\n  async register({ name, email, password }) {\n    const response = await fetch(`${ENDPOINTS.ENDPOINT}/register`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ name, email, password }),\n    });\n    return response.json();\n  },\n\n  async login({ email, password }) {\n    const response = await fetch(`${ENDPOINTS.ENDPOINT}/login`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ email, password }),\n    });\n    return response.json();\n  },\n};\n\nexport const NotificationAPI = {\n  async subscribePushNotification(subscription) {\n    const response = await fetch(\n      `${ENDPOINTS.ENDPOINT}/notifications/subscribe`,\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getAuthToken()}`,\n        },\n        body: JSON.stringify({\n          endpoint: subscription.endpoint,\n          keys: {\n            p256dh: subscription.keys.p256dh,\n            auth: subscription.keys.auth,\n          },\n        }),\n      }\n    );\n    return response.json();\n  },\n\n  async unsubscribePushNotification(endpoint) {\n    const response = await fetch(\n      `${ENDPOINTS.ENDPOINT}/notifications/subscribe`,\n      {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getAuthToken()}`,\n        },\n        body: JSON.stringify({ endpoint }),\n      }\n    );\n    return response.json();\n  },\n\n  async sendStoryNotification(storyId) {\n    const response = await fetch(\n      `${ENDPOINTS.ENDPOINT}/stories/${storyId}/notify`,\n      {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${getAuthToken()}`,\n        },\n      }\n    );\n    return response.json();\n  },\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/flowater-webpack-final/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkflowater_webpack\"] = self[\"webpackChunkflowater_webpack\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [96], function() { return __webpack_require__(343); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","LoginPresenter","constructor","view","this","init","form","document","getElementById","errorElement","bindEvents","addEventListener","async","e","preventDefault","handleLogin","email","value","password","clearErrors","showLoader","response","AuthAPI","login","error","showError","message","setAuthToken","loginResult","token","showSuccess","setTimeout","window","location","href","hideLoader","textContent","className","style","display","focus","RegisterPage","render","container","createElement","innerHTML","afterRender","querySelector","RegisterPresenter","STORY_STORE","BOOKMARK_STORE","dbPromise","openDB","upgrade","db","objectStoreNames","contains","createObjectStore","keyPath","StoryIDB","getAllStories","getAll","saveStories","stories","tx","transaction","story","store","put","done","deleteStory","id","delete","clearAll","clear","addBookmark","completeStory","name","description","photoUrl","lat","lon","createdAt","Date","toISOString","isBookmarked","get","deleteBookmark","getAllBookmarks","HomePage","LaporanPresenter","listStory","_getAllStories","length","validStories","filter","showStories","localStories","StoryAPI","L","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","LaporanPage","storiesContainer","map","clearBtn","then","mod","default","alert","skipLink","focusTarget","setAttribute","initialMap","center","scrollWheelZoom","zoom","attribution","maxZoom","addTo","addMarkers","eachLayer","layer","removeLayer","forEach","bindPopup","toLocaleString","setView","withBookmark","_generateStoryCard","join","_attachBookmarkListeners","storyIdb","querySelectorAll","btn","dataset","find","s","bookmarked","classList","toggle","stopPropagation","remove","add","AddStoryPresenter","state","marker","photoFile","mediaStream","selectedCamera","_setupDOMReferences","_initializeMap","_setupEventListeners","_loadCameras","elements","photoInput","photoPreview","cameraPreview","cameraSelect","getLocationBtn","latInput","lonInput","key","Error","mapContainer","_leaflet_id","reuse","invalidateSize","tap","on","_setLocation","latlng","lng","_switchCamera","target","catch","console","_toggleCamera","_capturePhoto","_stopCamera","hidden","_getCurrentLocation","_clearLocation","_handleSubmit","_handleFileSelect","navigator","mediaDevices","getUserMedia","video","getTracks","track","stop","devices","enumerateDevices","availableCameras","d","kind","_updateCameraOptions","backCamera","cam","label","toLowerCase","includes","deviceId","select","device","option","text","options","appendChild","constraints","exact","facingMode","width","ideal","height","srcObject","Promise","resolve","onloadedmetadata","play","enabled","load","pause","canvas","paused","readyState","HTMLMediaElement","HAVE_ENOUGH_DATA","videoWidth","videoHeight","getContext","drawImage","toBlob","blob","File","now","type","src","URL","createObjectURL","event","file","files","match","position","reject","geolocation","getCurrentPosition","enableHighAccuracy","timeout","coords","latitude","longitude","_getGeoError","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","setLatLng","trim","formData","FormData","append","getAuthToken","addStory","addStoryGuest","Notification","permission","serviceWorker","ready","registration","showNotification","body","icon","tag","vibrate","data","dateOfArrival","primaryKey","hash","onPageRevisit","AddStoryPage","presenter","isFirstRender","onPageRevisited","clearError","DetailPresenter","storyAPI","handleSkipLink","loadStoryDetail","getStoryDetail","showStoryDetail","NotFoundPage","lottie","renderer","loop","autoplay","animationData","BookmarkPage","el","/","checkAuthenticatedRoute","/laporan","/bookmark","split","/addLaporan","AddLaporanPage","/login","checkUnauthenticatedRouteOnly","LoginPage","/register","*","/404","extractPathnameSegments","path","splitUrl","resource","constructRouteFromSegments","pathSegments","pathname","concat","getActivePathname","replace","getActiveRoute","urlBase64ToUint8Array","base64String","base64","repeat","rawData","atob","outputArray","Uint8Array","i","charCodeAt","isPushSupported","requestNotificationPermission","requestPermission","getCurrentSubscription","pushManager","getSubscription","subscribeUser","subscription","convertedVapidKey","CONFIG","VAPID_PUBLIC_KEY","subscribe","userVisibleOnly","applicationServerKey","endpoint","sendSubscriptionToServer","unsubscribeUser","unsubscribe","fetch","BASE_URL","method","headers","Authorization","JSON","stringify","ok","json","deleteSubscriptionFromServer","localStorage","removeItem","keys","p256dh","endpointParts","extractP256dhKey","auth","crypto","getRandomValues","errorData","initializePushNotifications","existingSubscription","recreateSubscription","_content","WeakMap","_drawerButton","_navigationDrawer","navigationDrawer","drawerButton","content","_classPrivateFieldInitSpec","_classPrivateFieldSet","_setupRouter","bind","_renderPageContent","_deferredPrompt","_setupDrawer","updateAuthMenu","_initializePushNotifications","_setupInstallPrompt","_showInstallButton","installButton","_installApp","prompt","outcome","userChoice","button","handleNavigation","url","startViewTransition","finished","routePath","pageResolver","routes","page","_classPrivateFieldGet","renderedContent","notFoundPage","link","navList","isAuth","isAuthenticated","menuItems","_updateNotificationButton","removeAuthToken","dispatchEvent","Event","startsWith","_handlePushNotification","notifButton","_checkSubscriptionStatus","onclick","_unsubscribeFromNotifications","_subscribeToNotifications","setupPushNotification","notificationButton","handleUnsubscribe","handleSubscribe","renderPage","app","App","loginPage","registerPage","initializeApp","register","newWorker","installing","LoadingIndicator","HTMLElement","super","attachShadow","mode","connectedCallback","shadowRoot","loader","customElements","define","setItem","getItem","handleRegister","ENDPOINTS","size","sendStoryNotification","storyId","notificationData","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","amdO","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","every","splice","r","n","getter","__esModule","a","definition","o","defineProperty","enumerable","obj","prop","hasOwnProperty","Symbol","toStringTag","p","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","push","__webpack_exports__"],"sourceRoot":""}